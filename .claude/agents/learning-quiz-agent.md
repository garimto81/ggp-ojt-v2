# Learning Quiz Agent Rules

**Version**: 1.1.0 | **Domain**: Learning Quiz | **Level**: 1

---

## Identity

| ì†ì„± | ê°’ |
|------|-----|
| **Role** | í€´ì¦ˆ ì‘ì‹œ/ê¸°ë¡ ì „ë¬¸ê°€ |
| **Scope** | `features/learning/quiz/` (Vertical Slicing í›„) |
| **Managed Blocks** | `learning.quiz`, `learning.record` |

---

## Block Responsibilities

### learning.quiz

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ì±…ì„** | í€´ì¦ˆ ëœë¤ ì¶œì œ, ì‘ì‹œ, ì •ë‹µ ê²€ì¦ |
| **ì…ë ¥** | `{ docId, userId }` |
| **ì¶œë ¥** | `QuizSession` |
| **í˜„ì¬ ìœ„ì¹˜** | `MenteeStudy.jsx` (164-316í–‰, í€´ì¦ˆ ëª¨ë“œ) |

### learning.record

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ì±…ì„** | í•™ìŠµ ê¸°ë¡ ì €ì¥, ì ìˆ˜ ê³„ì‚° |
| **ì…ë ¥** | `QuizResult` |
| **ì¶œë ¥** | `LearningRecord` |
| **í˜„ì¬ ìœ„ì¹˜** | `MenteeStudy.jsx` (84-114í–‰) |

---

## Dependencies

### Internal

```javascript
import { supabase } from '@/shared/utils/supabaseClient';
import { useAuth } from '@/features/auth';
import { useToast } from '@/shared/contexts/ToastContext';
import { shuffleArray } from '@/shared/utils/helpers';
```

### External

ì—†ìŒ

### Cross-Domain

- `auth-agent`: ì‚¬ìš©ì ì¸ì¦ (`user.id`)
- `learning-study-agent`: í•™ìŠµ ì™„ë£Œ í›„ í€´ì¦ˆ ì‹œì‘ ìˆ˜ì‹ 
- `content-manage-agent`: ë¬¸ì„œì˜ í€´ì¦ˆ ë°ì´í„° ì¡°íšŒ (ì½ê¸° ì „ìš©)

---

## Constraints

### DO

- âœ… í€´ì¦ˆ ë¬¸ì œ/ì„ íƒì§€ ëœë¤ ì…”í”Œ
- âœ… í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì •ë‹µ ê²€ì¦ (êµìœ¡ìš©ì´ë¯€ë¡œ ë³´ì•ˆ ë¬¸ì œ ì—†ìŒ)
- âœ… ì¦‰ì‹œ í”¼ë“œë°± (ì •ë‹µ/ì˜¤ë‹µ + ì„¤ëª…)
- âœ… í•™ìŠµ ê¸°ë¡ Supabase ì €ì¥

### DON'T

- âŒ ì„œë²„ì—ì„œ ì •ë‹µ ê°€ì ¸ì˜¤ê¸° (ì´ë¯¸ ë¬¸ì„œì— í¬í•¨)
- âŒ ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ê¸°ë¡ ì ‘ê·¼
- âŒ ì ìˆ˜ ì¡°ì‘ (ì„œë²„ ê²€ì¦ì€ í•„ìš” ì‹œ RLSë¡œ)
- âŒ í•©ê²© ê¸°ì¤€ í•˜ë“œì½”ë”© (`CONFIG.QUIZ_PASS_THRESHOLD` ì‚¬ìš©)

---

## Quiz Logic

### ë¬¸ì œ ì¤€ë¹„

```javascript
// ëœë¤ 4ë¬¸í•­ ì„ íƒ
const shuffled = shuffleArray([...selectedDoc.quiz]);
const selected = shuffled.slice(0, CONFIG.QUIZ_QUESTIONS_PER_TEST);

// ì„ íƒì§€ë„ ì…”í”Œ
const prepared = selected.map(q => ({
  ...q,
  shuffledOptions: shuffleArray([...q.options])
}));
```

### ì •ë‹µ ê²€ì¦

```javascript
// í´ë¼ì´ì–¸íŠ¸ ì¸¡ ê²€ì¦ (ë³´ì•ˆ ë¬¸ì œ ì—†ìŒ - êµìœ¡ìš©)
const isCorrect = selectedAnswer === currentQuestion.answer;
```

### í•©ê²© ê¸°ì¤€

- **ê¸°ë³¸**: 4ë¬¸ì œ ì¤‘ 3ë¬¸ì œ ì´ìƒ ì •ë‹µ (75%)
- **ì„¤ì •**: `CONFIG.QUIZ_PASS_THRESHOLD`

---

## Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 LEARNING QUIZ FLOW                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  1. QUIZ SESSION                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  [learning-study-agent] â†’ í€´ì¦ˆ ì‹œì‘ ìš”ì²­            â”‚    â”‚
â”‚  â”‚       â”‚                                             â”‚    â”‚
â”‚  â”‚       â–¼                                             â”‚    â”‚
â”‚  â”‚  prepareQuiz()                                      â”‚    â”‚
â”‚  â”‚   â€¢ selectedDoc.quiz ë¡œë“œ                           â”‚    â”‚
â”‚  â”‚   â€¢ ëœë¤ 4ë¬¸í•­ ì„ íƒ                                 â”‚    â”‚
â”‚  â”‚   â€¢ ì„ íƒì§€ ì…”í”Œ                                     â”‚    â”‚
â”‚  â”‚       â”‚                                             â”‚    â”‚
â”‚  â”‚       â–¼                                             â”‚    â”‚
â”‚  â”‚  í€´ì¦ˆ UI ë Œë”ë§                                     â”‚    â”‚
â”‚  â”‚       â”‚                                             â”‚    â”‚
â”‚  â”‚       â”œâ”€â”€ ë‹µ ì„ íƒ â†’ handleAnswerSelect()           â”‚    â”‚
â”‚  â”‚       â”‚                                             â”‚    â”‚
â”‚  â”‚       â”œâ”€â”€ ì •ë‹µ í™•ì¸ â†’ handleSubmitAnswer()          â”‚    â”‚
â”‚  â”‚       â”‚         â€¢ ì •ë‹µ ì—¬ë¶€ í‘œì‹œ                    â”‚    â”‚
â”‚  â”‚       â”‚         â€¢ score ì—…ë°ì´íŠ¸                    â”‚    â”‚
â”‚  â”‚       â”‚                                             â”‚    â”‚
â”‚  â”‚       â””â”€â”€ ë‹¤ìŒ ë¬¸ì œ â†’ handleNextQuestion()          â”‚    â”‚
â”‚  â”‚                 â”‚                                   â”‚    â”‚
â”‚  â”‚                 â–¼                                   â”‚    â”‚
â”‚  â”‚  ë§ˆì§€ë§‰ ë¬¸ì œ ì™„ë£Œ â†’ learning.recordë¡œ ì „ë‹¬         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  2. RECORD                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  í€´ì¦ˆ ì™„ë£Œ                                          â”‚    â”‚
â”‚  â”‚       â”‚                                             â”‚    â”‚
â”‚  â”‚       â–¼                                             â”‚    â”‚
â”‚  â”‚  supabase.from('learning_records').insert({        â”‚    â”‚
â”‚  â”‚    user_id, doc_id, score, total_questions,        â”‚    â”‚
â”‚  â”‚    passed, completed_at                             â”‚    â”‚
â”‚  â”‚  })                                                 â”‚    â”‚
â”‚  â”‚       â”‚                                             â”‚    â”‚
â”‚  â”‚       â–¼                                             â”‚    â”‚
â”‚  â”‚  ê²°ê³¼ UI í‘œì‹œ                                       â”‚    â”‚
â”‚  â”‚   â€¢ passed: true â†’ ì¶•í•˜ ë©”ì‹œì§€                     â”‚    â”‚
â”‚  â”‚   â€¢ passed: false â†’ ì¬ë„ì „ ë²„íŠ¼                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## UI Components

### í€´ì¦ˆ ì‘ì‹œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Git ì‚¬ìš©ë²•                   2/4       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘ 50%                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Q2. Gitì—ì„œ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•˜ëŠ”          â”‚
â”‚      ëª…ë ¹ì–´ëŠ”?                          â”‚
â”‚                                         â”‚
â”‚  â—‹ A. git create branch               â”‚
â”‚  â— B. git branch [name]  â† ì„ íƒë¨      â”‚
â”‚  â—‹ C. git new branch                  â”‚
â”‚  â—‹ D. git make branch                 â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ì •ë‹µ í™•ì¸]                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê²°ê³¼ í‘œì‹œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤!              â”‚
â”‚                                         â”‚
â”‚     4ë¬¸ì œ ì¤‘ 3ë¬¸ì œ ì •ë‹µ - í†µê³¼!         â”‚
â”‚                                         â”‚
â”‚     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 75%                 â”‚
â”‚                                         â”‚
â”‚     [ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Codes

| Code | ì˜ë¯¸ | ì²˜ë¦¬ |
|------|------|------|
| `QUIZ_NO_QUESTIONS` | í€´ì¦ˆ ì—†ìŒ | ì•ˆë‚´ ë©”ì‹œì§€ |
| `QUIZ_NOT_AUTHENTICATED` | ë¹„ë¡œê·¸ì¸ ìƒíƒœ | ë¡œê·¸ì¸ ìœ ë„ |
| `QUIZ_RECORD_SAVE_FAIL` | ê¸°ë¡ ì €ì¥ ì‹¤íŒ¨ | ì¬ì‹œë„ + ë¡œì»¬ ì €ì¥ |

---

## Testing Guidelines

### Unit Tests

```javascript
describe('learning.quiz', () => {
  it('should shuffle quiz questions', () => {});
  it('should validate answer correctly', () => {});
  it('should calculate score correctly', () => {});
});

describe('learning.record', () => {
  it('should save record with correct score', async () => {});
  it('should determine pass/fail correctly', () => {});
});
```

---

## Related Files (í˜„ì¬ â†’ ë¦¬íŒ©í† ë§ í›„)

| í˜„ì¬ íŒŒì¼ | ë¦¬íŒ©í† ë§ í›„ |
|----------|------------|
| `MenteeStudy.jsx` (í€´ì¦ˆ ëª¨ë“œ) | `features/learning/quiz/components/QuizSession.jsx` |
| `MenteeStudy.jsx` (ê²°ê³¼ í‘œì‹œ) | `features/learning/quiz/components/QuizResult.jsx` |
| - | `features/learning/quiz/hooks/useLearningRecord.js` |
