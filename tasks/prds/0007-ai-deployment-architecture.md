# PRD 0007: AI ë°°í¬ ì•„í‚¤í…ì²˜ ë° Fallback ì „ëµ

**Version**: 1.0
**Date**: 2025-12-08
**Author**: Claude Code
**Status**: Draft
**Related Issues**: #103, #101, #96

---

## 1. ë¬¸ì œ ì •ì˜

### 1.1 í˜„ì¬ ë¬¸ì œì 

| ë¬¸ì œ | ì›ì¸ | ì˜í–¥ |
|------|------|------|
| Vercelì—ì„œ Local AI ì—°ê²° ë¶ˆê°€ | HTTPS â†’ HTTP Mixed Content ì°¨ë‹¨ | ë°°í¬ í™˜ê²½ì—ì„œ Local AI ì‚¬ìš© ë¶ˆê°€ |
| WebLLM ë¬´í•œ ë¡œë”© | 2.4GB ëª¨ë¸ ë‹¤ìš´ë¡œë“œ + ì´ˆê¸°í™” ì‹œê°„ | ì‚¬ìš©ì ì´íƒˆ, UX ì €í•˜ |
| Fallback Content ë¯¸ì‘ë™ | WebLLM ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬ ë¡œì§ ë¶€ì¬ | AI ì‹¤íŒ¨ ì‹œ ì•„ë¬´ ê²ƒë„ í‘œì‹œ ì•ˆë¨ |

### 1.2 í™˜ê²½ë³„ ìƒí™©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     í˜„ì¬ ì•„í‚¤í…ì²˜ ë¬¸ì œ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [Vercel HTTPS]                    [Local AI HTTP]              â”‚
â”‚       â”‚                                  â”‚                      â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€ âŒ Mixed Content â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                    (ë¸Œë¼ìš°ì € ì°¨ë‹¨)                                â”‚
â”‚                                                                 â”‚
â”‚  [WebLLM]                                                       â”‚
â”‚       â”‚                                                         â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€ âŒ ë¬´í•œ ë¡œë”© (íƒ€ì„ì•„ì›ƒ ì—†ìŒ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                 â”‚
â”‚  [Fallback Content]                                             â”‚
â”‚       â”‚                                                         â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€ âŒ í˜¸ì¶œ ì•ˆë¨ (WebLLMì´ ëë‚˜ì§€ ì•ŠìŒ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ì†”ë£¨ì…˜ ê°œìš”

### 2.1 ë°°í¬ í™˜ê²½ë³„ ì „ëµ

| í™˜ê²½ | AI ì—”ì§„ | êµ¬í˜„ ë°©ì‹ |
|------|---------|----------|
| **ê°œë°œ (localhost)** | Local AI â†’ WebLLM â†’ Fallback | í˜„ì¬ êµ¬ì¡° ìœ ì§€ |
| **í”„ë¡œë•ì…˜ (Vercel)** | WebLLM â†’ Cloud API â†’ Fallback | Local AI ë¹„í™œì„±í™” |
| **ì‚¬ë‚´ ë°°í¬ (Docker)** | Local AI â†’ WebLLM â†’ Fallback | ë™ì¼ origin ë°°í¬ |

### 2.2 AI ì—”ì§„ ìš°ì„ ìˆœìœ„ (ìµœì¢…)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AI ì—”ì§„ Fallback ì²´ì¸                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. Local AI (vLLM)                                             â”‚
â”‚     â”œâ”€ ì¡°ê±´: HTTP í™˜ê²½ ë˜ëŠ” HTTPS+HTTPS                          â”‚
â”‚     â”œâ”€ íƒ€ì„ì•„ì›ƒ: 5ì´ˆ                                             â”‚
â”‚     â””â”€ ì‹¤íŒ¨ ì‹œ â†’ 2ë²ˆìœ¼ë¡œ                                         â”‚
â”‚                                                                 â”‚
â”‚  2. WebLLM (ë¸Œë¼ìš°ì €)                                            â”‚
â”‚     â”œâ”€ ì¡°ê±´: WebGPU ì§€ì›                                         â”‚
â”‚     â”œâ”€ ë¡œë”© íƒ€ì„ì•„ì›ƒ: 30ì´ˆ (ì²« ë¡œë”©), 10ì´ˆ (ì¬ì‹œë„)                â”‚
â”‚     â”œâ”€ ìƒì„± íƒ€ì„ì•„ì›ƒ: 60ì´ˆ                                       â”‚
â”‚     â””â”€ ì‹¤íŒ¨/íƒ€ì„ì•„ì›ƒ ì‹œ â†’ 3ë²ˆìœ¼ë¡œ                                 â”‚
â”‚                                                                 â”‚
â”‚  3. Cloud API (Gemini)                                          â”‚
â”‚     â”œâ”€ ì¡°ê±´: API í‚¤ ì„¤ì •ë¨                                       â”‚
â”‚     â”œâ”€ íƒ€ì„ì•„ì›ƒ: 30ì´ˆ                                            â”‚
â”‚     â””â”€ ì‹¤íŒ¨ ì‹œ â†’ 4ë²ˆìœ¼ë¡œ                                         â”‚
â”‚                                                                 â”‚
â”‚  4. Fallback Content                                            â”‚
â”‚     â”œâ”€ ì¡°ê±´: í•­ìƒ ì‚¬ìš© ê°€ëŠ¥                                       â”‚
â”‚     â””â”€ ì›ë³¸ í…ìŠ¤íŠ¸ + ìë™ ìƒì„± í€´ì¦ˆ                               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ì†”ë£¨ì…˜ A: ë°°í¬ í™˜ê²½ Local AI ì§€ì›

### 3.1 Option A-1: Cloudflare Tunnel (ê¶Œì¥)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Cloudflare Tunnel êµ¬ì¡°                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [Vercel HTTPS]                                                 â”‚
â”‚       â”‚                                                         â”‚
â”‚       â–¼                                                         â”‚
â”‚  [https://localai.your-domain.com]  â† Cloudflare Tunnel         â”‚
â”‚       â”‚                                                         â”‚
â”‚       â–¼                                                         â”‚
â”‚  [cloudflared]  â†  ì‚¬ë‚´ ì„œë²„ì—ì„œ ì‹¤í–‰                             â”‚
â”‚       â”‚                                                         â”‚
â”‚       â–¼                                                         â”‚
â”‚  [http://localhost:8001]  â† vLLM ì„œë²„                            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì¥ì **:
- ë¬´ë£Œ (Cloudflare Zero Trust)
- SSL ìë™ ì ìš©
- ì™¸ë¶€ í¬íŠ¸ ì˜¤í”ˆ ë¶ˆí•„ìš”

**ì„¤ì • ë°©ë²•**:
```bash
# ì‚¬ë‚´ ì„œë²„ì—ì„œ ì‹¤í–‰
cloudflared tunnel create localai
cloudflared tunnel route dns localai localai.your-domain.com
cloudflared tunnel run --url http://localhost:8001 localai
```

### 3.2 Option A-2: Nginx Reverse Proxy + Let's Encrypt

```nginx
# /etc/nginx/sites-available/localai
server {
    listen 443 ssl;
    server_name localai.your-domain.com;

    ssl_certificate /etc/letsencrypt/live/localai.your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/localai.your-domain.com/privkey.pem;

    location / {
        proxy_pass http://127.0.0.1:8001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## 4. ì†”ë£¨ì…˜ B: Docker ì‚¬ë‚´ ë°°í¬

### 4.1 ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Docker Compose êµ¬ì¡°                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  docker-compose.yml                                             â”‚
â”‚  â”œâ”€â”€ nginx (port 80/443)                                        â”‚
â”‚  â”‚     â””â”€â”€ SSL termination + routing                            â”‚
â”‚  â”œâ”€â”€ frontend (React build)                                     â”‚
â”‚  â”‚     â””â”€â”€ static files serving                                 â”‚
â”‚  â””â”€â”€ vllm (port 8001 internal)                                  â”‚
â”‚        â””â”€â”€ Local AI server                                      â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  nginx  â”‚â”€â”€â”€â”€â–¶â”‚  frontend   â”‚     â”‚  vLLM   â”‚                â”‚
â”‚  â”‚  :443   â”‚     â”‚  (static)   â”‚     â”‚  :8001  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â–²â”€â”€â”€â”€â”˜                â”‚
â”‚       â”‚                                    â”‚                    â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚              /api/v1/* â†’ vLLM proxy                             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 docker-compose.yml

```yaml
version: '3.8'

services:
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./frontend/dist:/usr/share/nginx/html
      - ./ssl:/etc/nginx/ssl
    depends_on:
      - vllm
    networks:
      - ojt-network

  vllm:
    image: vllm/vllm-openai:latest
    runtime: nvidia
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
    command: >
      --model Qwen/Qwen3-4B
      --host 0.0.0.0
      --port 8001
      --max-model-len 8192
    networks:
      - ojt-network
    # ì™¸ë¶€ ë…¸ì¶œ ì•ˆí•¨ (nginxë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼)

networks:
  ojt-network:
    driver: bridge
```

### 4.3 nginx.conf

```nginx
events {
    worker_connections 1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    server {
        listen 80;
        listen 443 ssl;

        ssl_certificate /etc/nginx/ssl/cert.pem;
        ssl_certificate_key /etc/nginx/ssl/key.pem;

        # Frontend
        location / {
            root /usr/share/nginx/html;
            try_files $uri $uri/ /index.html;
        }

        # Local AI API Proxy (Same Origin!)
        location /api/v1/ {
            proxy_pass http://vllm:8001/v1/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_read_timeout 120s;
        }
    }
}
```

### 4.4 í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
# .env.docker
VITE_LOCAL_AI_URL=/api  # Same origin, no CORS issues!
VITE_SUPABASE_URL=https://xxx.supabase.co
VITE_SUPABASE_ANON_KEY=xxx
```

---

## 5. ì†”ë£¨ì…˜ C: WebLLM + Fallback ê°œì„ 

### 5.0 í•µì‹¬ UX: ì‚¬ìš©ì ì£¼ë„ Fallback ì „í™˜

**ìš”êµ¬ì‚¬í•­**: ì‚¬ìš©ìê°€ WebLLM ëŒ€ê¸° ì¤‘ ì–¸ì œë“ ì§€ Fallbackìœ¼ë¡œ ì¦‰ì‹œ ì „í™˜ ê°€ëŠ¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WebLLM ë¡œë”© ì¤‘ UI                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸŒ WebLLM ëª¨ë¸ ë¡œë”© ì¤‘...                                       â”‚
â”‚                                                                 â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 48%                                    â”‚
â”‚  ë‹¤ìš´ë¡œë“œ: 1.2GB / 2.4GB                                         â”‚
â”‚                                                                 â”‚
â”‚  â±ï¸ ì˜ˆìƒ ëŒ€ê¸° ì‹œê°„: ì•½ 2ë¶„                                       â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â”‚  [ğŸ”„ ê³„ì† ëŒ€ê¸°]        [â­ï¸ Fallbackìœ¼ë¡œ ê±´ë„ˆë›°ê¸°]        â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â”‚  ğŸ’¡ Fallback: AI ë¶„ì„ ì—†ì´ ì›ë³¸ í…ìŠ¤íŠ¸ë¡œ ì¦‰ì‹œ ë“±ë¡       â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**êµ¬í˜„ ë°©ì‹**: AbortController ê¸°ë°˜ ì·¨ì†Œ

```javascript
// WebLLM ì·¨ì†Œ ê°€ëŠ¥í•œ ë¡œë”©
const abortController = new AbortController();

// ì‚¬ìš©ìê°€ "Fallbackìœ¼ë¡œ ê±´ë„ˆë›°ê¸°" í´ë¦­
const handleSkipToFallback = () => {
  abortController.abort();  // WebLLM ì¦‰ì‹œ ì·¨ì†Œ
  setStatus('fallback');
  generateFallbackContent();
};

// WebLLM with AbortSignal
try {
  await initWebLLM(onProgress, { signal: abortController.signal });
} catch (error) {
  if (error.name === 'AbortError') {
    console.log('[WebLLM] ì‚¬ìš©ìì— ì˜í•´ ì·¨ì†Œë¨');
    return null;  // Fallbackìœ¼ë¡œ ì „í™˜
  }
  throw error;
}
```

### 5.1 í˜„ì¬ ë¬¸ì œ

```javascript
// í˜„ì¬ ì½”ë“œ (ë¬¸ì œ)
async function generateWithWebLLMEngine(contentText, title, onProgress) {
  const { initWebLLM } = await import('./webllm.js');
  await initWebLLM(onProgress);  // âŒ íƒ€ì„ì•„ì›ƒ ì—†ìŒ! ë¬´í•œ ëŒ€ê¸° ê°€ëŠ¥
  // ...
}
```

### 5.2 ê°œì„ ëœ Fallback ë¡œì§

```javascript
// ê°œì„ ëœ ì½”ë“œ
const WEBLLM_LOAD_TIMEOUT = 30000;  // 30ì´ˆ
const WEBLLM_GENERATE_TIMEOUT = 60000;  // 60ì´ˆ

async function generateWithWebLLMEngine(contentText, title, onProgress) {
  const { initWebLLM, generateWithWebLLM } = await import('./webllm.js');

  // 1. WebLLM ë¡œë”© with íƒ€ì„ì•„ì›ƒ
  try {
    await Promise.race([
      initWebLLM(onProgress),
      new Promise((_, reject) =>
        setTimeout(() => reject(new Error('WebLLM ë¡œë”© íƒ€ì„ì•„ì›ƒ (30ì´ˆ)')), WEBLLM_LOAD_TIMEOUT)
      )
    ]);
  } catch (error) {
    console.warn('[WebLLM] ë¡œë”© ì‹¤íŒ¨/íƒ€ì„ì•„ì›ƒ:', error.message);
    throw error;  // Fallbackìœ¼ë¡œ ì „í™˜
  }

  // 2. ì½˜í…ì¸  ìƒì„± with íƒ€ì„ì•„ì›ƒ
  try {
    const result = await Promise.race([
      generateWithWebLLM(contentText, title, onProgress),
      new Promise((_, reject) =>
        setTimeout(() => reject(new Error('WebLLM ìƒì„± íƒ€ì„ì•„ì›ƒ (60ì´ˆ)')), WEBLLM_GENERATE_TIMEOUT)
      )
    ]);
    return result;
  } catch (error) {
    console.warn('[WebLLM] ìƒì„± ì‹¤íŒ¨/íƒ€ì„ì•„ì›ƒ:', error.message);
    throw error;
  }
}
```

### 5.3 generateOJTContent ê°œì„ 

```javascript
export async function generateOJTContent(contentText, title, _step, _total, onProgress) {
  const startTime = Date.now();
  const errors = [];

  // 1. Local AI ì‹œë„ (HTTP í™˜ê²½ì—ì„œë§Œ)
  if (isLocalAIAvailable()) {
    try {
      onProgress?.('Local AI ì„œë²„ ì—°ê²° í™•ì¸ ì¤‘...');
      const result = await withTimeout(
        generateWithLocalAI(contentText, title, onProgress),
        5000,
        'Local AI ì—°ê²° íƒ€ì„ì•„ì›ƒ'
      );
      if (result) {
        onProgress?.('âœ… Local AI ìƒì„± ì™„ë£Œ');
        return result;
      }
    } catch (error) {
      errors.push({ engine: 'localai', error: error.message });
      onProgress?.(`Local AI ì‹¤íŒ¨: ${error.message}`);
    }
  }

  // 2. WebLLM ì‹œë„
  try {
    onProgress?.('WebLLM ì—”ì§„ ì¤€ë¹„ ì¤‘...');
    const result = await withTimeout(
      generateWithWebLLMEngine(contentText, title, onProgress),
      90000,  // ë¡œë”© 30ì´ˆ + ìƒì„± 60ì´ˆ
      'WebLLM íƒ€ì„ì•„ì›ƒ'
    );
    if (result) {
      onProgress?.('âœ… WebLLM ìƒì„± ì™„ë£Œ');
      return result;
    }
  } catch (error) {
    errors.push({ engine: 'webllm', error: error.message });
    onProgress?.(`WebLLM ì‹¤íŒ¨: ${error.message}`);
  }

  // 3. Cloud API ì‹œë„ (ì„¤ì •ëœ ê²½ìš°)
  if (isCloudAPIConfigured()) {
    try {
      onProgress?.('Cloud APIë¡œ ìƒì„± ì¤‘...');
      const result = await withTimeout(
        generateWithCloudAPI(contentText, title, onProgress),
        30000,
        'Cloud API íƒ€ì„ì•„ì›ƒ'
      );
      if (result) {
        onProgress?.('âœ… Cloud API ìƒì„± ì™„ë£Œ');
        return result;
      }
    } catch (error) {
      errors.push({ engine: 'cloudapi', error: error.message });
      onProgress?.(`Cloud API ì‹¤íŒ¨: ${error.message}`);
    }
  }

  // 4. Fallback Content (ìµœí›„ì˜ ìˆ˜ë‹¨)
  onProgress?.('âš ï¸ AI ë¶„ì„ ì‹¤íŒ¨ - Fallback ì½˜í…ì¸  ìƒì„± ì¤‘...');
  const fallback = createFallbackContent(contentText, title, errors);
  fallback.generation_time = Date.now() - startTime;
  fallback.fallback_reason = errors.map(e => `${e.engine}: ${e.error}`).join(', ');

  return fallback;
}
```

---

## 6. UI ëª©ì—… ë””ìì¸

### 6.1 ìƒíƒœë³„ UI í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AI ì—”ì§„ ìƒíƒœ UI í”Œë¡œìš°                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤

[ì´ˆê¸° ìƒíƒœ]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”„ AI ì—”ì§„ ì´ˆê¸°í™” ì¤‘...              â”‚
â”‚                                     â”‚
â”‚ â–ª Local AI ì—°ê²° í™•ì¸ ì¤‘...           â”‚
â”‚   [=========>          ] 45%        â”‚
â”‚                                     â”‚
â”‚ ì˜ˆìƒ ì†Œìš” ì‹œê°„: ì•½ 5ì´ˆ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼ (Local AI ì„±ê³µ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ–¥ï¸ Local AI ì—°ê²°ë¨        [ìƒˆë¡œê³ ì¹¨] â”‚
â”‚                                     â”‚
â”‚ âœ… ëª¨ë¸: Qwen/Qwen3-4B               â”‚
â”‚    ì„œë²„: http://10.10.100.209:8001   â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Local AI ì¥ì :                â”‚   â”‚
â”‚ â”‚ â€¢ ì‚¬ë‚´ ì„œë²„ì—ì„œ ì§ì ‘ ì²˜ë¦¬      â”‚   â”‚
â”‚ â”‚ â€¢ ë¹ ë¥¸ ì‘ë‹µ ì†ë„               â”‚   â”‚
â”‚ â”‚ â€¢ ëŒ€ê·œëª¨ ëª¨ë¸ ì‚¬ìš© ê°€ëŠ¥        â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          â–¼ (Local AI ì‹¤íŒ¨ - HTTPS í™˜ê²½)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ Local AI ì‚¬ìš© ë¶ˆê°€     [ìƒˆë¡œê³ ì¹¨] â”‚
â”‚                                     â”‚
â”‚ ì›ì¸: HTTPS í™˜ê²½ì—ì„œ HTTP ì„œë²„ ì°¨ë‹¨   â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ’¡ í•´ê²° ë°©ë²•:                  â”‚   â”‚
â”‚ â”‚ 1. ê°œë°œ ì„œë²„(localhost) ì‚¬ìš©   â”‚   â”‚
â”‚ â”‚ 2. Docker ì‚¬ë‚´ ë°°í¬            â”‚   â”‚
â”‚ â”‚ 3. Cloudflare Tunnel ì„¤ì •     â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ [WebLLMìœ¼ë¡œ ëŒ€ì²´]  [ê±´ë„ˆë›°ê¸°]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          â–¼ (WebLLM ì‹œì‘)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŒ WebLLM ëª¨ë¸ ë¡œë”© ì¤‘...            â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 58%      â”‚   â”‚
â”‚ â”‚ ë‹¤ìš´ë¡œë“œ: 1.4GB / 2.4GB        â”‚   â”‚
â”‚ â”‚ ì˜ˆìƒ ì‹œê°„: ì•½ 2ë¶„               â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ â±ï¸ íƒ€ì„ì•„ì›ƒê¹Œì§€: 25ì´ˆ                â”‚
â”‚                                     â”‚
â”‚ [ì·¨ì†Œí•˜ê³  Fallback ì‚¬ìš©]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          â–¼ (WebLLM íƒ€ì„ì•„ì›ƒ/ì‹¤íŒ¨)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âŒ WebLLM ë¡œë”© ì‹¤íŒ¨       [ë‹¤ì‹œì‹œë„] â”‚
â”‚                                     â”‚
â”‚ ì‚¬ìœ : 30ì´ˆ íƒ€ì„ì•„ì›ƒ ì´ˆê³¼             â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ“‹ Fallback ì˜µì…˜:              â”‚   â”‚
â”‚ â”‚                               â”‚   â”‚
â”‚ â”‚ â—‹ Cloud API ì‚¬ìš© (Gemini)     â”‚   â”‚
â”‚ â”‚   â†’ API í‚¤ í•„ìš”, ë¹ ë¥¸ ì‘ë‹µ     â”‚   â”‚
â”‚ â”‚                               â”‚   â”‚
â”‚ â”‚ â— ì›ë³¸ í…ìŠ¤íŠ¸ë¡œ ë“±ë¡           â”‚   â”‚
â”‚ â”‚   â†’ AI ë¶„ì„ ì—†ì´ ì›ë¬¸ ê·¸ëŒ€ë¡œ   â”‚   â”‚
â”‚ â”‚   â†’ í€´ì¦ˆ ìë™ ìƒì„± (ê¸°ë³¸í˜•)    â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ [Fallbackìœ¼ë¡œ ì§„í–‰]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          â–¼ (Fallback Content)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“„ Fallback ëª¨ë“œ           [ì¬ì‹œë„] â”‚
â”‚                                     â”‚
â”‚ AI ë¶„ì„ ì—†ì´ ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤ â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ í¬í•¨ í•­ëª©:                     â”‚   â”‚
â”‚ â”‚ âœ… ì›ë³¸ í…ìŠ¤íŠ¸ (ì„¹ì…˜ 1ê°œ)       â”‚   â”‚
â”‚ â”‚ âœ… ê¸°ë³¸ í€´ì¦ˆ 10ê°œ (ìë™ ìƒì„±)   â”‚   â”‚
â”‚ â”‚ âš ï¸ AI ìš”ì•½ ì—†ìŒ                â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ ğŸ’¡ ë‚˜ì¤‘ì— AI ì—°ê²° í›„ ì¬ìƒì„± ê°€ëŠ¥     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ì½˜í…ì¸  ìƒì„± ì¤‘ ì§„í–‰ í‘œì‹œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ì½˜í…ì¸  ìƒì„± ì§„í–‰ í‘œì‹œ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤

[ì •ìƒ í”Œë¡œìš°]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ OJT ì½˜í…ì¸  ìƒì„± ì¤‘...             â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ âœ… 1. Local AI ì—°ê²° í™•ì¸       â”‚   â”‚
â”‚ â”‚ âœ… 2. í…ìŠ¤íŠ¸ ë¶„ì„ ì™„ë£Œ         â”‚   â”‚
â”‚ â”‚ ğŸ”„ 3. ì„¹ì…˜ êµ¬ì¡°í™” ì¤‘... (45ì´ˆ)  â”‚   â”‚
â”‚ â”‚ â—‹ 4. í€´ì¦ˆ ìƒì„±                â”‚   â”‚
â”‚ â”‚ â—‹ 5. ê²€ì¦ ë° ì €ì¥             â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ ì‚¬ìš© ì—”ì§„: Local AI (Qwen3-4B)       â”‚
â”‚ ê²½ê³¼ ì‹œê°„: 32ì´ˆ                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Fallback í”Œë¡œìš°]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ OJT ì½˜í…ì¸  ìƒì„± ì¤‘...             â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ âŒ 1. Local AI: ì—°ê²° ì‹¤íŒ¨      â”‚   â”‚
â”‚ â”‚ âŒ 2. WebLLM: íƒ€ì„ì•„ì›ƒ (30ì´ˆ)   â”‚   â”‚
â”‚ â”‚ â­ï¸ 3. Cloud API: ë¯¸ì„¤ì •        â”‚   â”‚
â”‚ â”‚ ğŸ”„ 4. Fallback ì½˜í…ì¸  ìƒì„± ì¤‘   â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ âš ï¸ AI ë¶„ì„ ì‹¤íŒ¨                     â”‚
â”‚ ì›ë³¸ í…ìŠ¤íŠ¸ë¡œ ë“±ë¡ë©ë‹ˆë‹¤             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 ì—ëŸ¬ ìƒíƒœ ìƒì„¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âŒ AI ì—”ì§„ ì˜¤ë¥˜ ìƒì„¸        [ë‹«ê¸°]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ ì‹œë„í•œ ì—”ì§„ ë° ê²°ê³¼:                 â”‚
â”‚                                     â”‚
â”‚ 1. Local AI                         â”‚
â”‚    ìƒíƒœ: âŒ ì‹¤íŒ¨                     â”‚
â”‚    ì›ì¸: Mixed Content Policy       â”‚
â”‚    ë©”ì‹œì§€: HTTPSì—ì„œ HTTP ì°¨ë‹¨       â”‚
â”‚                                     â”‚
â”‚ 2. WebLLM                           â”‚
â”‚    ìƒíƒœ: âŒ íƒ€ì„ì•„ì›ƒ                 â”‚
â”‚    ì›ì¸: ëª¨ë¸ ë‹¤ìš´ë¡œë“œ ì§€ì—°           â”‚
â”‚    ë©”ì‹œì§€: 30ì´ˆ íƒ€ì„ì•„ì›ƒ ì´ˆê³¼        â”‚
â”‚                                     â”‚
â”‚ 3. Cloud API                        â”‚
â”‚    ìƒíƒœ: â­ï¸ ê±´ë„ˆëœ€                  â”‚
â”‚    ì›ì¸: API í‚¤ ë¯¸ì„¤ì •               â”‚
â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ê´€ë¦¬ì ì„¤ì •ì—ì„œ Cloud APIë¥¼    â”‚   â”‚
â”‚ â”‚ í™œì„±í™”í•˜ë©´ Fallback í’ˆì§ˆì´     â”‚   â”‚
â”‚ â”‚ í–¥ìƒë©ë‹ˆë‹¤.                    â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚ [Fallbackìœ¼ë¡œ ì§„í–‰] [ì„¤ì •ìœ¼ë¡œ ì´ë™]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. Fallback Content ê°œì„ 

### 7.1 í˜„ì¬ Fallback ë¬¸ì œ

```javascript
// í˜„ì¬ (ë‹¨ìˆœ)
function createFallbackContent(text, title) {
  return {
    title,
    sections: [{ title: 'ë‚´ìš©', content: text }],
    quiz: createPlaceholderQuiz(10, title),  // "[ìë™ ìƒì„±]" í‘œì‹œ
  };
}
```

### 7.2 ê°œì„ ëœ Fallback Content

```javascript
/**
 * ê°œì„ ëœ Fallback Content ìƒì„±
 * - ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ ë‹¨ë½ë³„ë¡œ ë¶„ë¦¬
 * - í‚¤ì›Œë“œ ê¸°ë°˜ ìë™ í€´ì¦ˆ ìƒì„±
 * - Fallback ì‚¬ìœ  ë° ì¬ìƒì„± ì˜µì…˜ í¬í•¨
 */
function createFallbackContent(text, title, errors = []) {
  // 1. í…ìŠ¤íŠ¸ ë‹¨ë½ ë¶„ë¦¬
  const paragraphs = text.split(/\n\n+/).filter(p => p.trim().length > 50);

  // 2. ì„¹ì…˜ ìë™ êµ¬ì„±
  const sections = paragraphs.length > 1
    ? paragraphs.slice(0, 5).map((p, i) => ({
        title: `ì„¹ì…˜ ${i + 1}`,
        content: `<p>${p.replace(/\n/g, '</p><p>')}</p>`,
      }))
    : [{ title: 'í•™ìŠµ ë‚´ìš©', content: `<p>${text}</p>` }];

  // 3. í‚¤ì›Œë“œ ì¶”ì¶œ ê¸°ë°˜ í€´ì¦ˆ ìƒì„±
  const keywords = extractKeywords(text);  // ëª…ì‚¬, ì „ë¬¸ìš©ì–´ ì¶”ì¶œ
  const quiz = generateKeywordQuiz(keywords, title, 10);

  // 4. ë©”íƒ€ ì •ë³´ í¬í•¨
  return {
    title,
    sections,
    quiz,
    summary: `ì´ ë¬¸ì„œëŠ” AI ë¶„ì„ ì—†ì´ ì›ë³¸ í…ìŠ¤íŠ¸ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. (${new Date().toLocaleString()})`,
    estimated_minutes: Math.max(5, Math.ceil(text.length / 500)),

    // Fallback ì „ìš© ë©”íƒ€ë°ì´í„°
    _fallback: {
      reason: errors.map(e => `${e.engine}: ${e.error}`).join('; '),
      timestamp: new Date().toISOString(),
      regeneratable: true,  // ë‚˜ì¤‘ì— AIë¡œ ì¬ìƒì„± ê°€ëŠ¥
    },
  };
}

/**
 * í‚¤ì›Œë“œ ê¸°ë°˜ í€´ì¦ˆ ìƒì„± (ë”ë¯¸ê°€ ì•„ë‹Œ ì‹¤ì œ ë‚´ìš© ê¸°ë°˜)
 */
function generateKeywordQuiz(keywords, title, count) {
  const templates = [
    { q: 'ë‹¤ìŒ ì¤‘ ${title}ì—ì„œ ë‹¤ë£¨ëŠ” ì£¼ìš” ê°œë…ì€?', type: 'concept' },
    { q: '${keyword}ì˜ ì˜ë¯¸ë¡œ ì˜¬ë°”ë¥¸ ê²ƒì€?', type: 'definition' },
    { q: '${title} ê´€ë ¨ ìš©ì–´ ì¤‘ í‹€ë¦° ê²ƒì€?', type: 'wrong' },
  ];

  return keywords.slice(0, count).map((keyword, i) => {
    const template = templates[i % templates.length];
    return {
      question: template.q.replace('${keyword}', keyword).replace('${title}', title),
      options: generateOptions(keyword, keywords),
      answer: 0,
      explanation: `${keyword}ëŠ” ì´ ë¬¸ì„œì˜ í•µì‹¬ ê°œë…ì…ë‹ˆë‹¤.`,
      isAuto: true,  // ìë™ ìƒì„± í‘œì‹œ
    };
  });
}
```

---

## 8. êµ¬í˜„ ê³„íš

### Phase 1: Fallback ì•ˆì •í™” (ìš°ì„ )
- [ ] WebLLM íƒ€ì„ì•„ì›ƒ ì¶”ê°€ (30ì´ˆ/60ì´ˆ)
- [ ] Fallback Content ê°œì„  (í‚¤ì›Œë“œ í€´ì¦ˆ)
- [ ] ì—ëŸ¬ ìƒíƒœ UI ê°œì„ 
- [ ] í…ŒìŠ¤íŠ¸ ì½”ë“œ ì¶”ê°€

### Phase 2: Docker ë°°í¬ ì˜µì…˜
- [ ] docker-compose.yml ì‘ì„±
- [ ] nginx.conf ì‘ì„±
- [ ] ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€
- [ ] ë°°í¬ ê°€ì´ë“œ ë¬¸ì„œí™”

### Phase 3: Cloud API í†µí•©
- [ ] Gemini API ì„œë¹„ìŠ¤ ëª¨ë“ˆ
- [ ] ê´€ë¦¬ì ì„¤ì • UI
- [ ] ì‚¬ìš©ëŸ‰ ì¶”ì 

### Phase 4: HTTPS Local AI (ì„ íƒ)
- [ ] Cloudflare Tunnel ê°€ì´ë“œ
- [ ] í™˜ê²½ ë³€ìˆ˜ ë¶„ê¸° ì²˜ë¦¬

---

## 9. í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

| # | ì‹œë‚˜ë¦¬ì˜¤ | ì˜ˆìƒ ê²°ê³¼ |
|---|----------|----------|
| 1 | localhost + Local AI | Local AI ì„±ê³µ |
| 2 | Vercel + Local AI | Mixed Content ì°¨ë‹¨ â†’ WebLLM ì „í™˜ |
| 3 | WebLLM 30ì´ˆ ì´ˆê³¼ | íƒ€ì„ì•„ì›ƒ â†’ Fallback |
| 4 | ëª¨ë“  ì—”ì§„ ì‹¤íŒ¨ | Fallback Content ìƒì„± |
| 5 | Docker ë°°í¬ | Local AI ì •ìƒ ë™ì‘ |

---

## 10. ì„±ê³µ ì§€í‘œ

- [ ] WebLLM ë¬´í•œ ë¡œë”© ì œê±° (30ì´ˆ íƒ€ì„ì•„ì›ƒ)
- [ ] Fallback Content 100% ë™ì‘
- [ ] ì—ëŸ¬ ë°œìƒ ì‹œ ëª…í™•í•œ ì‚¬ìœ  í‘œì‹œ
- [ ] Docker ë°°í¬ 1ì‹œê°„ ë‚´ ì™„ë£Œ ê°€ëŠ¥

---

## ì°¸ê³ 

- PRD 0006: Gemini API Cloud Fallback
- Issue #103: AI Engine Selector UI
- Issue #101: Local AI Integration
